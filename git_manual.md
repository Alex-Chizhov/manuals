*Git базовое руководство. Примеры основных команд. Основано на курсе "lynda.com git - essential training"*

 
## Базовые команды


**Узнать в какой директории Git**

    $ which git

**Узнать версию Git**

    git --version

**Настройки конфигурации**

System:

    git config --system

User:

    git config --global

Project:

	git config 

Настройка имени пользователя и email:
 
    git config --global user.name "Kevin Skoglund"
    git config --global user.email "kevins@gamil.com"
    
    git config --global --list
    user.name=Kevin Skoglund
    user.email=kevins@gamil.com
    
    git config user.name
    Kevin Skoglund
    
**Задаём редактор текста по умолчанию**

    git config --global core.editor "notepad++.exe"

**Задаем использование цветного текста в консоли**

    git config --global color.ui true

**Чтение файла из консоли**

    $ cat .gitconfig

**Инициализация git репозитория**

    git init

**Добавление всех изменений в индекс**

    git add .

**Сделать коммит**

    git commit -m "Заголовок первая строка - менее 50 символов. 
                    Пустая строка. 
                    Описание коммита максимум 72 символа в каждой строке"


**Посмотреть совершенные коммиты**

    git log

**Посмотреть лимитированное число совершенных коммитов**

    git log -n 5

**Посмотреть коммиты сделанные с определенной даты**

    git log --since=2019-05-14


**Посмотреть коммиты сделанные до определенной**

    git log --until=2020-05-14


**Посмотреть совершенные коммиты определенным автором**

    git log --author="Alex"


**Посмотреть совершенные коммиты используя регулярные выражения для поиска в ОПИСАНИИ коммита**

    git log --grep="первый"


**Посмотреть коммит по id(хеш). Достаточно первый 4 символов id(хеш)**

    git log 01c0


**Получение списка коммитов в одну линию для каждого коммита**

    git log --oneline
    git log --oneline -5


**Получение списка коммитов начиная с определенного и заканчивая определенным**

    git log 9004...c66d

получаем 3 коммита:

	9004
	0aad
	b78a
	
**Просмотр изменения файлов в коммитах**

    git log -p

	
**Посмотреть изменения кода в конкретном коммите**

    git show HEAD
    git show b78ad


**Статус изменений файлов**

    git status


**Убрать один файл из буфера(индекса)**

    git rm --cached myfile.txt


**Убрать все файлы внутри папки из буфера(индекса)**

    git rm -r --cached MyFolderName


**Посмотреть разницу между версией файла в репозитории и версией в рабочей области**

    git diff

-- or --

    git diff --color-words


**Посмотреть разницу между версией файла в репозитории и версией в буфере(Staging Area)**

    git diff --staged

-- or --

    git diff --staged --color-words

**Удаление файла в репозитории
Можно использовать после удаления из рабочей области
Можно использовать сразу. Файл будет удален безвозвратно с диска, но сохранится в репозитории и доступен по коммиту**

    git rm myfile.txt

**Переименование файла из консоли (Изменения добавляются в буфер автоматически)**

    git mv file_1.txt file_one.txt


**Перемещение файла из консоли (Изменения добавляются в буфер автоматически)**

    git mv file_1.txt folder/file_1.txt



## Отмена Изменений


**Отмена изменений в рабочей директории**

`--` нужны для указания текущей ветки branch 

Мы восстанавливаем файл myfile.html из текущей ветки

    git checkout -- myfile.html


**Отменить добавление файла в индекс(буфер)**

    git reset HEAD myfile.txt

--or--

    git restore --staged myfile.txt


**Изменить код последнего коммита(дополнить), изменить сообщение последнего коммита**

(Опционально) Вносим изменение в код 

Добавляем изменения в индекс:
	
	git add .

Выполняем `git commit` с опцией `--amend`, и при необходимости меняем сообщение коммита

    git commit --amend -m "Сообщение коммита"

Отправляем изменения на сервер. Коммит перезаписывается на сервере

	git push --force

**Отмена изменений коммита целиком со всеми изменениями. Отменяющим коммитом**

    git revert HEAD
    git revert 7380b


**Отмена несколько коммитов сразу**

Указываем на какой коммит будет указывать HEAD

    git reset
		 
		--soft
		Перемещает указатель HEAD на конкретный коммит. 
		Все изменения следующих коммитов за новым HEAD остаются в рабочей директории и в индексации буфера.
		Можно вернуться на старый HEAD коммит предварительно нужно сохранить его хеш(id).

		--mixed(по умолчанию)
		Перемещает указатель HEAD на конкретный коммит.
		Буфер очищается, все изменения следующих коммитов за новым HEAD остаются только в рабочей директории.
		Можно вернуться на старый HEAD коммит предварительно нужно сохранить его хеш(id).
		
		--hard
		Перемещает указатель HEAD на конкретный коммит.
		Буфер очищается, все изменения удаленных коммитов удаляются из рабочей директории.
		Можно вернуться на старый HEAD коммит предварительно нужно сохранить его хеш(id).
		
		

**Удалить не отслеживаемые файлы из рабочей директории**

Покажет какие файлы будут удалены (Тестовый режим)

    git clean -n

Удалит все файлы из рабочей директории которые не неаходятся в буфере/репозитории

    git clean -f


## Игнорирование файлов

Файл .gitignore в корне проекта рабочей директории позволяет указывать файлы для игнорирования


**Игнорируем любой файл который заканчивается на .php**

    *.php


**Не нужно игнорировать index.php**

    !index.php


**Игнорирование всех файлов внутри папки videos**

    home/videos/


**Коментарий внутри файла .gitignore**

    # comment

**.gitignore_global для ОС пользователя**

Файлы добавленные в .gitignore_global будут игнорироваться в каждом репозитории на компьютере.

В папке пользователя windwos создаем файл .gitignore_global с необходимым набором для игнора файлов.

В той же папке в файле .gitconfig прописываем ссылку на созданный файл .gitignore_global:
	
	[core]
		excludesfile = C:/Users/UserName/.gitignore_global


**Игнорирование уже отслеживаемых файлов**

Удаляем отслеживаемый файл из буфера командой:

    git rm --cached myfile.py
    
И далее добавляем этот файл в .gitignore


**Отслеживание пустых папок (директорий)**

Git не отслеживает пустые папки.
Для отслеживание пустой паки принято добавлять в нее пустой файл .gitkeep




## Переход по дереву коммитов


**Посмотреть родительский коммит**

    git show HEAD^
             acf87504^
             master^
             HEAD~
             HEAD~1

**Посмотреть grandparent коммит**

    git show HEAD^^
            acf87504^^
            master^^
            HEAD~2

**Посмотреть разницу между двумя коммитами**

    git diff b78a..9004
    git diff b78a..9004 tours.html



## Бранчинг


**Посмотреть список бранчей и текущий бранч на него указывает знак**

    git branch


**Создать новый бранч**

    git branch new_branch_name


**Переключится на другой бранч**

    git checkout branch_name


**Создание бранча и чекаут(переключение) на этот новый бранч сразу одной командой**

    git chekout -b new_branch_name


**Посмотреть разницу в бранчах(ветках)**

    git duff master other_branch_name
    git duff master..other_branch_name


**Посмотреть какие бранчи(ветки) включены(слиты) в текущий бранч(ветку)**

    git branch --merged


**Переименование бранча(ветки)**

    git branch -m old_branch_name new_branch_name


**Удаление бранча(ветки)**

    git branch -d branch_name




## Слияние бранчей (Объединение)


**Слияние бранчей(мерджинг)**

Необходимо переключится на ветку в которую мы сливаем изменения другого бранча
    
    git merge branch_name


**Сделать слияние создав коммит слияния**

    git merge --no--ff branch_name


**Сделать быстрое слияния, только если оно будет быстрым (без коммита слияния)**

    git merge --ff-only branch_name


**Прервать слияние, при необходимости разрешения конфликта слияния бранчей**

    git merge --abort


**При возникновении конфликта при слиянии необходимо**

1.Открыть файл с конфликтом

2.Удалить вспомогательный код от Git
	
	<<<<<<< HEAD
	<p color="red">text</p>
	=======
	<p color="green">text</p>
	>>>>>>> master
	
3.Оставить только необходимый код нашего приложения
    
    <p color="green">text</p>

4.Выполнить git add file_name

5.Выполнить git commit


**Вывод в консоли коммитов с графическим отображение бранчей**

    git log --graph --oneline --all --decorate




## Работа с копилкой (Stash)


**Сохранить изменения в копилку (stash)**

    git stash save "Description"


**Просмотреть копилку (stash)**

    git stash list


**Посмотреть изменения в коде у конкретного номера(с изменениями) в копилке,
аналог команды  diff для копилки**

    git stash show -p 0
    git stash show -p 1
    git stash show -p 2


**Восстановить изменения кода из копилки (stash)**

    git stash apply

**Помимо восстановления изменений в рабочую директорию удаляет из копилки это изменение**

    git stash pop	 


**Удаление одного изменения из копилки (stash)**

    git stash drop 0
    git stash drop 1
    git stash drop 2


**Удаление всех изменений из копилки**

    git stash clear



## Работа с удаленным репозиторием (remotes)



**Посмотреть все удаленные сервера о которых знает текущий git репозиторий**

    git remote


**Добавить удаленный сервер**

`<alias>` - псевдоним, то как мы хотим назвать удаленный сервер

`<url>` - адрес удаленного сервера 

    git remote add <alias> <url>
    git remote add origin https://github.com/Alex-Chizhov/explore_california.git


**Удалить удаленный репозиторий**

    git remote rm <alias>
    git remote rm origin 


**Отправить код в удаленный репозиторий указав псевдоним удаленного сервера и ветку для отправки**

`-u` позволяет отслеживать в дальнейшем ветку master удаленным сервером

    git push -u origin master


**Посмотреть удаленные бранчи**

    git branch -r


**Посмотреть удаленные и локальные бранчи**

    git branch -a


**Загрузить git проект c удаленного сервера(сделать локальную копию проекта)**

    git clone https://github.com/Alex-Chizhov/explore_california.git


**Отправить изменения на удаленный сервер**

    git push


**Отправить новую ветку на удаленный сервер (без отслеживания изменений сервером в дальнейшем)**

    git push origin branch_name


**Отправить новую ветку на удаленный сервер (с отслеживанием изменений сервером в дальнейшем)**

`-u` позволяет отслеживать в дальнейшем ветку master удаленным сервером

    git push -u origin branch_name


**Начать отслеживать изменения на удаленном сервере ветки (бранча)**

Например ветка уже запушена на сервер, но не еще не отслеживается

Выполнять из нужного бранча


    git branch -u origin/this_branch_name

или добавить в .git/config

    [bransh branch_name]
        remote = origin
        merge = refs/heads/non_tracking


**Перестать отслеживать ветку на удаленном сервере**
Выполнять из нужного бранча

    git branch --unset-upstream


**Загрузить все изменения с сервера**

Загружает в локальную ветку origin/master используемую для отслеживания изменение с удаленного сервера

Следует делать fetch:

1.Перед началом работы

2.Перед push

3.Выполнять fetch часто во избежание конфликтов с изменениями других разработчиков

    git fetch 
    git fetch origin


**Сделать слияние origin/master с master веткой**

    git merge origin/master


**Команда для (git fetch + git merge)**

Слияние произойдет в текущий бранч

    git pull


**Сделать checkout удаленного бранча, загрузить удаленный бранч**

Создаем отслеживаемый бранч

    git branch branch_name origin/branch_name

или

    git checkout -b branch_name origin/branch_name


**Удалить бранч на удаленном сервере (github или др)**

    git push origin :branch_name

или

    git push origin --delete branch_name




## Дополнительные Возможности


**Добавление короткого псевдонима для команды**

Имеет смысл добавлять в глобальный config файл Users\UserName\.gitconfig

    git config --global alias.st "status"
    git config --global alias.l "log --oneline --graph --decorate --abbrev-commit --all"

или вручную добавить в файл Users\UserName\.gitconfig

    [alias]
        st = status
        l = log --oneline --graph --decorate --abbrev-commit --all
